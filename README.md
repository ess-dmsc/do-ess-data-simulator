DonkiOrchestra as an ESS Data Simulator
=======================================

DonkiOrchestra is a specialised framework that offers advanced WORKFLOW control for beamline end-station software. It has been re-purposed to be used with KAFKA-ESS technologies aiming at providing rapid SCRIPTING of complex scenarios of DATA STREAM generation and processing for SIMULATION purposes.


DESCRIPTION
-----------

The repository consists of two main directories: DonkiDirector and DonkiPlayer.

USAGE
-----

* Director

In order to start the DonkiDirector do:
```
cd DonkiDirector
./DonkiDirector_cmdline.py
```
This application accepts user input commands that allows you to setup the players and start a sequence with a defined number of triggers. Available commands are:

start, stop, players?, triggers=N, priority[playername]=N, quit

* Player

In order to start a generci DonkiPlayer do:
```
cd DonkiPlayer
./DonkiPlayer.py player_name localhost:50010 scripts/just_action.py
```
You have to specify the arguments ```player_name``` (a unique name for the player), ```localhost:50010``` (the URL for the information server) and ```action_code``` (the script that will run as the sequence of triggers arrives to the Player).

EXAMPLES
--------

* Simple example
In one terminal run:
```
cd DonkiDirector
./DonkiDirector_cmdline.py
```
Set the number of the desired triggers:
```
triggers=N
```

In a separate terminal starts a Player:
```
cd DonkiPLayer
./DonkiPlayer.py player0 localhost:50010 scripts/just_action.py
```

* Kafka
In order to perform an example of the framework you can follow the steps above to make DonkiOrchestra send a sequence of triggers to three Players (*run_player_0.py*, *run_player_1.py*, *run_player_2.py*) and streams data generated by the ```mcstas-generator``` to three Kafka topics (*test-topic-0*, *test-topic-1*, *test-topic-2*) on the broker "localhost".

Steps:
- starts Kafka server
- starts DonkiDirector
- starts DonkiPlayer(s)





